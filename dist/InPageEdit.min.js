!function(e){var t={};function i(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(a,o,function(t){return e[t]}.bind(null,o));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=16)}([function(e,t){e.exports={_msg:function(e){return`(i18njs-${e})`}}},function(e,t){var i='<div class="ipe-progress" style="width: 100%"><div class="ipe-progress-bar"></div></div>';e.exports={$br:"<br>",br:"<br>",$hr:"<hr>",hr:"<hr>",$progress:i,progress:i}},function(e,t,i){var a=mw.config.get(),o=i(3);e.exports={_analysis:function(e){InPageEdit.doNotCollectMyInfo;var t={action:"submit",url:a.wgServer+a.wgArticlePath.replace("$1",""),sitename:a.wgSiteName,username:a.wgUserName,function:e};$.ajax({url:o.analysis,data:t,type:"post",dataType:"json"}).done((function(e){console.log("[InPageEdit] Analysis response\nStatus: "+e.status+"\nMessage: "+e.msg)}))}}},function(e){e.exports=JSON.parse('{"aboutUrl":"https://ipe.netlify.app/","analysis":"https://doc.wjghj.cn/inpageedit-v2/analysis/api/index.php","analysisUrl":"https://dragon-fish.github.io/inpageedit-v2/analysis/","githubLink":"https://github.com/Dragon-Fish/InPageEdit-v2","specialNotice":"https://wjghj.fast.io/InPageEdit/specialNotice.json","updatelogsUrl":"https://ipe.netlify.app/update/"}')},function(e,t,i){const a=i(22).version;e.exports=a},function(e,t,i){var a=window.InPageEdit||{};const{_analysis:o}=i(2),{_msg:n}=i(0),{$br:s,$hr:r}=i(1),d=i(3),l=i(4);var c={default:{doNotCollectMyInfo:!1,doNotShowLocalWarn:!1,editMinor:!1,editSummary:n("preference-summary-default"),lockToolBox:!1,redLinkQuickEdit:!0,outSideClose:!0,watchList:Boolean(mw.user.options.get("watchdefault"))},get:function(e){e=e||void 0;var t=localStorage.getItem("InPageEditPreference")||"{}";try{t=JSON.parse(t)}catch(e){t={}}"object"==typeof a.myPreference&&(t=$.extend({},t,a.myPreference));var i=$.extend({},c.default,t);return"string"==typeof e&&""!==e?i.setting?i[e]:null:i},set:function(e={},t){var i={};if("string"==typeof e&&void 0!==t)i[e]=t;else{if("object"!=typeof e)return;i=e}i=$.extend({},c.get(),i),i=JSON.stringify(i),localStorage.setItem("InPageEditPreference",i)},modal:function(){if(!($("#ipe-preference-form").length>0)){mw.hook("pluginPreference").fire(),c.set();var e=c.get();o("plugin_setting"),ssi_modal.show({outSideClose:!1,title:n("preference-title")+" - "+l,content:$("<section>",{id:"ipe-preference-form",class:"ipe-preference-form"}).append($("<h4>",{text:n("preference-editor-label")}),$("<label>").append($("<input>",{id:"outSideClose",type:"checkbox"}).prop("checked",e.outSideClose),$("<span>",{text:n("preference-outSideClose")})),s,$("<label>").append($("<input>",{id:"editMinor",type:"checkbox"}).prop("checked",e.editMinor),$("<span>",{text:n("preference-setMinor")})),s,$("<h4>",{text:n("preference-summary-label")}),$("<label>",{for:"editSummary",style:"padding-left: 0; font-size: small",html:n("preference-editSummary")}),s,$("<input>",{id:"editSummary",style:"width: 96%",value:e.editSummary,placeholder:"Edit via InPageEdit, yeah~"}),$("<h4>",{text:n("preference-analysis-label")}),$("<span>",{style:"font-size: small; line-height: 0.9em",html:n("preference-analysis-view",`[${d.analysisUrl} ${d.analysisUrl}]`)}),$("<h4>",{text:n("preference-about-label")}),$("<button>",{class:"btn btn-secondary",onclick:"InPageEdit.about()",text:n("preference-aboutAndHelp")}),$("<button>",{class:"btn btn-secondary",style:"margin-left: 1em;",onclick:"InPageEdit.versionInfo()",text:n("preference-updatelog")}),$("<a>",{href:"https://ipe.miraheze.org/wiki/",target:"_blank",style:"margin-left: 1em;"}).append($("<button>",{class:"btn btn-secondary",text:n("preference-translate")})),$("<a>",{href:"https://discord.gg/VUVAh8w",target:"_blank",style:"margin-left: 1em;"}).append($("<button>",{class:"btn btn-secondary",text:n("preference-discord")})),r,$("<strong>",{style:"font-size: small; line-height: 0.9em",text:n("preference-savelocal-label")}),s,$("<span>",{style:"font-size: small; line-height: 0.9em",text:n("preference-savelocal")}).append($("<a>",{href:"javascript:;",id:"ipeSaveLocalShow",text:n("preference-savelocal-btn")}).click((function(){ssi_modal.dialog({className:"in-page-edit",center:!0,title:n("preference-savelocal-popup-title"),content:'<section id="ipeSaveLocal">'+n("preference-savelocal-popup")+'<br/><textarea style="font-size: 12px; resize: none; width: 100%; height: 10em;" readonly></textarea><br/>'+n("preference-savelocal-popup-notice")+"</section>",okBtn:{className:"btn btn-primary btn-single",label:n("ok")}}),$("#ipeSaveLocal textarea").val("/** InPageEdit Preferences **/\nwindow.InPageEdit = window.InPageEdit || {}; // Keep this line\nInPageEdit.myPreference = "+JSON.stringify($.extend({},c.get(),$("#ipe-preference-form").data()),null,2))})))),sizeClass:"dialog",className:"in-page-edit ipe-preference",center:!0,buttons:[{label:n("preference-reset"),className:"btn btn-danger",method:function(e,t){ssi_modal.confirm({title:n("preference-reset-confirm-title"),content:n("preference-reset-confirm"),className:"in-page-edit",center:!0,okBtn:{label:n("ok"),className:"btn btn-danger"},cancelBtn:{label:n("cancel"),className:"btn"}},e=>{if(!e)return!1;c.set(c.default),t.close()})}},{label:n("preference-save"),className:"btn btn-primary",method:function(e,t){c.set($("#ipe-preference-form").data()),t.close()}}],onShow:function(){function e(){"checkbox"===this.type?$("#ipe-preference-form").data(this.id,this.checked):"text"===this.type&&$("#ipe-preference-form").data(this.id,this.value)}$("#ipe-preference-form input").each(e).change(e),void 0!==a.myPreference&&($("#ipe-preference-form input, .ipe-preference .ssi-modalBtn").attr({disabled:"disabled"}),$("#ipe-preference-form").prepend($("<p>",{class:"has-local-warn",style:"padding-left: 8px; border-left: 6px solid orange; font-size: small;",html:n("preference-savelocal-popup-haslocal")})))}})}}};e.exports={pluginPreference:c}},function(e,t){var i=mw.config.get();e.exports={_hasRight:function(e){return!0!==i.wgUserIsBlocked&&mw.config.get("wgUserRights").indexOf(e)>-1}}},function(e,t,i){var a=new mw.Api,o=mw.config.get();const{_analysis:n}=i(2),{_msg:s}=i(0),{_hasRight:r}=i(6),{$br:d,$progress:l}=i(1),{findAndReplace:c}=i(11),{pluginPreference:p}=i(5),{progress:m}=i(12),{quickPreview:f}=i(13),{quickDiff:g}=i(14);var u=function(e){mw.hook("InPageEdit.quickEdit").fire(),"string"==typeof(e=e||{})&&(e={page:e});var t={page:o.wgPageName,pageId:-1,revision:null,summaryRevision:"",section:null,editText:"",editMinor:!1,editSummary:s("preference-summary-default"),editNotice:"",outSideClose:!0,jsonGet:{action:"parse",page:e.page||o.wgPageName,prop:"wikitext|langlinks|categories|templates|images|sections",format:"json"},jsonPost:{},pageDetail:{},jumpTo:"",reload:!0},i=p.get(),h=new Date,b=h.getTime(),v=h.toUTCString();(e=$.extend({},t,e,i)).page=decodeURIComponent(e.page),n("quick_edit"),null!==e.revision&&""!==e.revision&&e.revision!==o.wgCurRevisionId?(ssi_modal.notify("warning",{className:"in-page-edit",content:s("notify-editing-history"),title:s("notify-info")}),delete e.jsonGet.page,e.jsonGet.oldid=e.revision,e.summaryRevision="("+s("editor-summary-rivision")+"[[Special:Diff/"+e.revision+"]])"):null!==e.section&&""!==e.section&&(e.jsonGet.section=e.section),console.time("[InPageEdit] 获取页面源代码"),console.info("[InPageEdit] QuickEdit start with options:"),console.table(e),ssi_modal.show({title:s("editor-title-editing")+': <u class="editPage">'+e.page.replace(/_/g," ")+"</u>",content:$("<div>").append(l,$("<section>",{class:"hideBeforeLoaded"}).append($("<div>",{class:"editTools"}).append($("<div>",{class:"btnGroup"}).append($("<div>",{class:"toolSelect"}).append($("<div>",{class:"label",text:s("editor-edittool-header")}),$("<ul>",{class:"ul-list"}).append($("<li>",{class:"editToolBtn","data-open":"\n== ","data-middle":s("editor-edittool-header-text"),"data-close":" ==\n",text:"H2"}),$("<li>",{class:"editToolBtn","data-open":"\n=== ","data-middle":s("editor-edittool-header-text"),"data-close":" ===\n",text:"H3"}),$("<li>",{class:"editToolBtn","data-open":"\n==== ","data-middle":s("editor-edittool-header-text"),"data-close":" ====\n",text:"H4"}),$("<li>",{class:"editToolBtn","data-open":"\n===== ","data-middle":s("editor-edittool-header-text"),"data-close":" =====\n",text:"H5"})))),$("<div>",{class:"btnGroup"}).append($("<span>",{class:"label",text:"格式"}),$("<button>",{class:"editToolBtn fa fa-bold btn","data-open":"'''","data-middle":s("editor-edittool-bold"),"data-close":"'''"}),$("<button>",{class:"editToolBtn fa fa-italic btn","data-open":"''","data-middle":s("editor-edittool-italic"),"data-close":"''"}),$("<button>",{class:"editToolBtn fa fa-list-ul btn","data-open":"\n* ","data-middle":s("editor-edittool-list-bulleted"),"data-close":"\n"}),$("<button>",{class:"editToolBtn fa fa-list-ol btn","data-open":"\n# ","data-middle":s("editor-edittool-list-numbered"),"data-close":"\n"}),$("<button>",{class:"editToolBtn fa fa-won btn","data-open":"<nowiki>","data-middle":s("editor-edittool-nowiki"),"data-close":"</nowiki>"}),$("<button>",{class:"editToolBtn fa fa-level-down fa-rotate-90 btn","data-open":"<br>\n","data-middle":"","data-close":""})),$("<div>",{class:"btnGroup"}).append($("<span>",{class:"label",text:"插入"}),$("<button>",{class:"editToolBtn fa fa-link btn","data-open":"[[","data-middle":s("editor-edittool-internal-link"),"data-close":"]]"}),$("<button>",{class:"editToolBtn fa fa-file-image-o btn","data-open":"[[File:","data-middle":"Example.png","data-close":"|thumb]]"}),$("<button>",{class:"editToolBtn btn","data-open":"\n<gallery>\n","data-middle":"Example1.jpg|Description\nExample2.png|Description","data-close":"\n</gallery>\n",html:'<span class="fa-stack"><i class="fa fa-picture-o fa-stack-1x"></i><i class="fa fa-picture-o fa-stack-1x" style="left: 2px;top: 2px;text-shadow: 1px 1px 0 #fff;"></i></span>'})),$("<div>",{class:"btnGroup extra",style:"display: none"}).append($("<span>",{class:"label",text:"自定义"})),$("<div>",{class:"btnGroup special-tools",style:"float: right"}).append($("<button>",{class:"btn fa fa-search"}).click((function(){c($(".ipe-editor.timestamp-"+b+" .editArea"))})))),$("<textarea>",{class:"editArea",style:"margin-top: 0;"}),$("<div>",{class:"editOptionsLabel hideBeforeLoaded"}).append($("<aside>",{class:"detailArea"}).append($("<label>",{class:"detailToggle",text:s("editor-detail-button-toggle")}),$("<div>",{class:"detailBtnGroup"}).append($("<a>",{href:"javascript:;",class:"detailBtn",id:"showTemplates",text:s("editor-detail-button-templates")})," | ",$("<a>",{href:"javascript:;",class:"detailBtn",id:"showImages",text:s("editor-detail-button-images")}))),$("<label>",{for:"editSummary",text:s("editSummary")}),d,$("<input>",{class:"editSummary",id:"editSummary",placeholder:"Edit via InPageEdit~",value:e.editSummary.replace(/\$oldid/gi,e.summaryRevision)}),d,$("<label>").append($("<input>",{type:"checkbox",class:"editMinor",id:"editMinor",checked:e.editMinor}),$("<span>",{text:s("markAsMinor")})),d,$("<label>").append($("<input>",{type:"checkbox",class:"reloadPage",id:"reloadPage",checked:e.reload}),$("<span>",{text:s("editor-reload-page")}))))),outSideClose:e.outSideClose,className:"in-page-edit ipe-editor timestamp-"+b,sizeClass:"large",buttons:[{label:s("editor-button-save"),className:"btn btn-primary leftBtn hideBeforeLoaded save-btn",method(t,i){ssi_modal.confirm({className:"in-page-edit",center:!0,content:s("editor-confirm-save"),okBtn:{className:"btn btn-primary",label:s("confirm")},cancelBtn:{className:"btn btn-secondary",label:s("cancel")}},(function(t){if(t){var r=$(".ipe-editor.timestamp-"+b+" .editArea").val(),d=$(".ipe-editor.timestamp-"+b+" .editMinor").prop("checked"),l=e.section,c=$(".ipe-editor.timestamp-"+b+" .editSummary").val();!function(t,i){n("quick_edit_save"),m(s("editor-title-saving")),e.jsonPost={action:"edit",basetimestamp:$(".ipe-editor.timestamp-"+b).data("basetimestamp"),starttimestamp:v,text:t.text,title:t.page,minor:t.minor,summary:t.summary,errorformat:"plaintext"},void 0!==t.section&&""!==t.section&&null!==t.section&&(e.jsonPost.section=t.section,delete e.jsonPost.basetimestamp);function r(e,t,i){m(!1);var a,o=i||e,n="";void 0!==o.errors?(e=o.errors[0].code,a=o.errors[0]["*"],n=""):"Success"!==o.edit.result?(e=o.edit.code||"Unknown",a=o.edit.info||"Reason unknown.",n=o.edit.warning||""):(e="unknown",a="Reason unknown.",n="Please contact plug-in author or try again."),ssi_modal.show({className:"in-page-edit",sizeClass:"dialog",center:!0,title:s("editor-save-error"),content:a+'<hr style="clear: both" />'+n}),ssi_modal.notify("error",{className:"in-page-edit",position:"right top",closeAfter:{time:15},title:s("notify-error"),content:s("editor-save-error")+"：<code>"+e+"</code>"}),console.error("[InPageEdit] Submit failed: \nCode: "+e)}a.postWithToken("csrf",e.jsonPost).done((function(a,n,d){if("Success"===a.edit.result){var l;if(m(!0),$(".ipe-editor.timestamp-"+b+" .reloadPage").prop("checked"))$(window).unbind("beforeunload"),l=s("notify-save-success"),setTimeout((function(){t.page===o.wgPageName?(window.location=mw.util.getUrl(t.page)+e.jumpTo,window.location.reload()):window.location.reload()}),500);else console.info("[InPageEdit] 将不会重载页面！"),l=s("notify-save-success-noreload"),setTimeout((function(){m(!1),$(".ipe-editor.timestamp-"+b+" .editArea").attr("data-confirmclose","true"),i.close()}),1500);ssi_modal.notify("success",{className:"in-page-edit",position:"right top",title:s("notify-success"),content:l})}else r(a,n,d)})).fail(r)}({text:r,page:e.page,minor:d,section:l,summary:c},i)}}))}},{label:s("editor-button-preview"),className:"btn btn-secondary leftBtn hideBeforeLoaded",method:function(){n("preview_edit");var t=$(".ipe-editor.timestamp-"+b+" .editArea").val();f({title:e.page,text:t,pst:!0})}},{label:s("editor-button-diff"),className:"btn btn-secondary leftBtn hideBeforeLoaded diff-btn",method:function(){}},{label:s("cancel"),className:"btn btn-danger",method:function(e,t){t.close()}}],beforeShow:function(){if($(".ipe-editor.timestamp-"+b+" .hideBeforeLoaded").hide(),$(".ipe-editor.timestamp-"+b+" .ipe-progress").css("margin",Number($(window).height()/3-50)+"px 0"),$(".ipe-editor.timestamp-"+b+" .editArea").css("height",$(window).height()/3*2-100),$(".ipe-editor.timestamp-"+b+" .editOptionsLabel").prependTo(".ipe-editor.timestamp-"+b+" .ssi-buttons"),$(".ipe-editor.timestamp-"+b+" .leftBtn").appendTo(".ipe-editor.timestamp-"+b+" .ssi-leftButtons"),$(".ipe-editor.timestamp-"+b+" .ssi-modalTitle").append($("<a>",{class:"showEditNotice",href:"javascript:void(0);",html:'<i class="fa fa-info-circle"></i> '+s("editor-has-editNotice"),style:"display: none;"}).click((function(){ssi_modal.show({className:"in-page-edit",center:!0,title:s("editor-title-editNotice"),content:'<section class="editNotice">'+$(".ipe-editor.timestamp-"+b).data("editNotice")+"</section>"})}))),InPageEdit.buttons){var e=InPageEdit.buttons;$(".ipe-editor.timestamp-"+b+" .btnGroup.extra").show();for(var t=0;t<e.length;t++){var i=e[t];a=i.open,o=i.middle,n=i.close,r=i.text,a=a||"",o=o||"",n=n||"",r="fa-"+r||!1,$(".ipe-editor.timestamp-"+b+" .btnGroup.extra").append($("<button>",{class:"editToolBtn btn","data-open":a,"data-middle":o,"data-close":n,html:`<i class="fa ${r}"></i>`}))}}var a,o,n,r;$(".ipe-editor.timestamp-"+b+" .editToolBtn").click((function(e){e.preventDefault();var t=$(this);!function(e,t){var i=t||$(".in-page-edit.ipe-editor .editArea")[0],a=i.selectionStart,o=i.selectionEnd,n=i.value.slice(a,o);i.value=i.value.slice(0,a)+(e.open||"")+(n||e.middle||"")+(e.close||"")+i.value.slice(o);var s=a+(e.open.length||0);i.setSelectionRange(s,s+(n.length||e.middle.length||0)),i.focus()}({open:t.attr("data-open")||"",middle:t.attr("data-middle")||"",close:t.attr("data-close")||""},$(".ipe-editor.timestamp-"+b+" .editArea")[0])}))},onShow(){function t(t){var i;e.pageDetail=t,t.error?(console.warn("[InPageEdit]警告：无法获取页面内容"),e.editText="\x3c!-- "+t.error.info+" --\x3e",e.pageId=-1,$(".ipe-editor.timestamp-"+b+" .detailArea").hide()):(e.editText=t.parse.wikitext["*"],e.pageId=t.parse.pageid),$(".ipe-editor.timestamp-"+b+" .ipe-progress").hide(),$(".ipe-editor.timestamp-"+b+" .hideBeforeLoaded").fadeIn(500),$(".ipe-editor.timestamp-"+b+" .editArea").val(e.editText+"\n"),null!==e.section?(i=(i=$(".ipe-editor.timestamp-"+b+" .editSummary").val()).replace(/\$section/gi,"/* "+t.parse.sections[0].line+" */"),$(".ipe-editor.timestamp-"+b+" .editSummary").val(i),$(".ipe-editor.timestamp-"+b+" .editPage").after('<span class="editSection">→'+t.parse.sections[0].line+"</span>"),e.jumpTo="#"+t.parse.sections[0].anchor):(i=(i=$(".ipe-editor.timestamp-"+b+" .editSummary").val()).replace(/\$section/gi,""),$(".ipe-editor.timestamp-"+b+" .editSummary").val(i),e.jumpTo=""),null!==e.revision&&""!==e.revision&&e.revision!==o.wgCurRevisionId?($(".ipe-editor.timestamp-"+b+" .editPage").after('<span class="editRevision">('+s("editor-title-editRevision")+"："+e.revision+")</span>"),$(".ipe-editor.timestamp-"+b+" .diff-btn").click(()=>{n("quick_diff_edit");var t=$(".ipe-editor.timestamp-"+b+" .editArea").val(),i={fromrev:e.revision,totext:t,hideBtn:!0,pageName:e.page,isPreview:!0};e.section&&(i.fromsection=e.section),g(i)})):$(".ipe-editor.timestamp-"+b+" .diff-btn").attr("disabled",!0),console.time("[InPageEdit] 获取页面基础信息");var d={action:"query",prop:"revisions|info",inprop:"protection",format:"json"};function l(t){if(e.namespace=t.query.pages[e.pageId].ns,e.protection=t.query.pages[e.pageId].protection||[],t.query.pages[e.pageId].revisions&&(e.revision=t.query.pages[e.pageId].revisions[0].revid),e.page=t.query.pages[e.pageId].title,$(".ipe-editor.timestamp-"+b+" .editPage").text(e.page),e.revision&&$(".ipe-editor.timestamp-"+b+" .diff-btn").attr("disabled",!1).click((function(){n("quick_diff_edit");var t=$(".ipe-editor.timestamp-"+b+" .editArea").val(),i={fromrev:e.revision,totext:t,hideBtn:!0,pageName:e.page,isPreview:!0};e.section&&(i.fromsection=e.section),g(i)})),e.protection.length>0)for(var i=0;i<e.protection.length;i++)"edit"===e.protection[i].type&&("autoconfirmed"===e.protection[i].level&&!r("autoconfirmed")||"sysop"===e.protection[i].level&&!r("editprotected")||8===o.wgNamespaceNumber&&!r("editinterface"))&&(ssi_modal.notify("dialog",{className:"in-page-edit",position:"center bottom",title:s("notify-no-right"),content:s("editor-no-right"),okBtn:{label:s("ok"),className:"btn btn-primary",method:function(e,t){t.close()}}}),$(".ipe-editor.timestamp-"+b+" .save-btn").addClass("btn-danger"));var d="Editnotice-"+e.namespace,l=d+"-"+e.page.replace(/_/," ").replace(o.wgFormattedNamespaces[e.namespace]+":","");a.get({action:"query",meta:"allmessages",ammessages:d+"|"+l}).done((function(t){var i=t.query.allmessages[0]["*"]||"",o=t.query.allmessages[1]["*"]||"";""===i&&""===o||a.post({action:"parse",title:e.page,contentmodel:"wikitext",preview:!0,text:o+"\n"+i}).done((function(t){e.editNotice=t.parse.text["*"];var i=$(".ipe-editor.timestamp-"+b).data("editNotice")||"";i+="\n"+e.editNotice,$(".ipe-editor.timestamp-"+b).data("editNotice",i),$(".ipe-editor.timestamp-"+b+" .showEditNotice").show()}))}))}-1!==e.pageId?d.pageids=e.pageId:d.titles=e.page,a.get(d).done((function(t){console.info("[InPageEdit] 获取页面基础信息成功"),console.timeEnd("[InPageEdit] 获取页面基础信息"),$(".ipe-editor.timestamp-"+b).data("basetimestamp",t.query.pages[e.pageId].revisions?t.query.pages[e.pageId].revisions[0].timestamp:v),l(t)})).fail((function(e,t,i){var a=i;console.timeEnd("[InPageEdit] 获取页面基础信息"),console.warn("[InPageEdit] 获取页面基础信息失败"),$(".ipe-editor.timestamp-"+b).data("basetimestamp",v),l(a)}))}mw.hook("InPageEdit.quickEdit.modal").fire(),$(".ipe-editor.timestamp-"+b+" .editArea").change((function(){$(this).attr("data-modifiled","true"),$(window).bind("beforeunload",(function(){return s("window-leave-confirm")}))})),!1===r("edit")&&(ssi_modal.notify("dialog",{className:"in-page-edit",position:"center bottom",title:s("notify-no-right"),content:s("editor-no-right"),okBtn:{label:s("ok"),className:"btn btn-primary",method:function(e,t){t.close()}}}),$(".ipe-editor.timestamp-"+b+" .save-btn").addClass("btn-danger")),a.get(e.jsonGet).done((function(e){console.timeEnd("[InPageEdit] 获取页面源代码"),t(e)})).fail((function(e,i,a){console.timeEnd("[InPageEdit] 获取页面源代码"),console.warn("[InPageEdit]警告：无法获取页面内容"),t(a)}))},beforeClose:function(e){if("true"===$(".ipe-editor.timestamp-"+b+" .editArea").attr("data-modifiled"))return"true"===$(".ipe-editor.timestamp-"+b+" .editArea").attr("data-confirmclose")?($(window).unbind("beforeunload"),e.options.keepContent=!1,e.options.beforeClose="",void e.close()):(ssi_modal.confirm({className:"in-page-edit",center:!0,content:s("editor-leave-confirm"),okBtn:{className:"btn btn-danger",label:s("confirm")},cancelBtn:{className:"btn btn-secondary",label:s("cancel")}},(function(e){!0===e&&t()})),!1);function t(){$(window).unbind("beforeunload"),e.options.keepContent=!1,e.options.beforeClose="",e.close(),ssi_modal.notify("info",{className:"in-page-edit",position:"right top",title:s("cancel"),content:s("notify-no-change")})}t()}}),$(".ipe-editor.timestamp-"+b+" .detailBtnGroup .detailBtn").click((function(){n("quick_edit_pagedetail");var t=$(this).attr("id"),i=$("<ul>");switch(t){case"showTemplates":var r,d=e.pageDetail.parse.templates;for(let e=0;e<d.length;e++)r=d[e]["*"],$("<li>").append($("<a>",{href:mw.util.getUrl(r),target:"_blank",text:r})," (",$("<a>",{href:"javascript:;",text:s("quick-edit"),class:"quickEditTemplate","data-template-name":r}),")").appendTo(i);ssi_modal.show({className:"in-page-edit quick-edit-detail",sizeClass:"dialog",title:s("editor-detail-title-templates"),content:i});break;case"showImages":var c,p=e.pageDetail.parse.images;for(let e=0;e<p.length;e++)c=p[e],$("<li>").append($("<a>",{href:mw.util.getUrl("File:"+c),target:"_balnk",text:c})," (",$("<a>",{href:"javascript:;",class:"quickViewImage",text:s("editor-detail-images-quickview"),"data-image-name":c})," | ",$("<a>",{href:o.wgScript+"?title=Special:Upload&wpDestFile="+c+"&wpForReUpload=1",target:"_balnk",text:s("editor-detail-images-upload")}),")").appendTo(i);ssi_modal.show({className:"in-page-edit quick-edit-detail",sizeClass:"dialog",title:s("editor-detail-title-images"),content:i})}$(".in-page-edit.quick-edit-detail .quickEditTemplate").click((function(){n("quick_edit_pagedetail_edit_template");var e=$(this).attr("data-template-name");u({page:e})})),$(".in-page-edit.quick-edit-detail .quickViewImage").click((function(){n("quick_edit_pagedetail_view_image");var e=$(this).attr("data-image-name");ssi_modal.show({className:"in-page-edit quick-view-image",center:!0,title:e.replace(/_/g," "),content:$("<center>",{id:"imageLayer"}).append(l),buttons:[{label:s("editor-detail-images-upload"),className:"btn btn-primary",method(){window.open(o.wgScript+"?title=Special:Upload&wpDestFile="+e+"&wpForReUpload=1")}},{label:s("close"),className:"btn btn-secondary",method:function(e,t){t.close()}}],onShow:function(){a.get({action:"query",format:"json",prop:"imageinfo",titles:"File:"+e.replace(/file:/g,""),iiprop:"url"}).done((function(e){$(".quick-view-image .ipe-progress").hide(),$(".quick-view-image #imageLayer").append($("<img>",{src:e.query.pages[-1].imageinfo[0].url,class:"loading",style:"max-width: 80%; max-height: 60vh"})),$(".quick-view-image #imageLayer img").load((function(){$(this).removeClass("loading")}))}))}})}))}))};e.exports={quickEdit:u}},function(e,t,i){const{_msg:a}=i(0),o=i(3),n=i(4);e.exports={versionInfo:function(){ssi_modal.show({className:"in-page-edit update-logs-modal",title:a("updatelog-title")+' - <span id="yourVersion">'+n+"</span>",content:$("<section>").append($("<iframe>",{style:"margin: 0;padding: 0;width: 100%;height: 80vh;border: 0;",src:o.updatelogsUrl})),buttons:[{label:"GitHub",className:"btn btn-secondary",method:function(){window.open(o.githubLink)}},{label:a("updatelog-about"),className:"btn btn-secondary",method:function(){window.open(o.aboutUrl)}},{label:a("close"),className:"btn btn-primary",method:function(e,t){t.close()}}]})}}},function(e,t,i){const{_msg:a}=i(0);e.exports={specialNotice:function(){ssi_modal.notify("dialog",{className:"in-page-edit ipe-special-notice",title:a("version-notice-title"),content:a("version-notice"),okBtn:{label:a("updatelog-dismiss"),className:"btn btn-primary"}},(function(e,t){localStorage.setItem("InPageEditNoticeId",a("noticeid")),t.close()}))}}},function(e,t,i){var a=mw.config.get();const{_msg:o}=i(0),{pluginPreference:n}=i(5),{quickEdit:s}=i(7);e.exports={articleLink:function(e){void 0===e&&(e=!0===n.get("redLinkQuickEdit")?$("#mw-content-text a"):$("#mw-content-text a:not(.new)")),e.each(()=>{if(void 0!==$(this).attr("href")){var e=$(this).attr("href"),t=mw.util.getParamValue("action",e)||mw.util.getParamValue("veaction",e),i=mw.util.getParamValue("title",e),n=mw.util.getParamValue("section",e).replace(/(T-)/gi,""),r=mw.util.getParamValue("oldid",e);if(e.split("/")[2]===location.href.split("/")[2]||"/"===e.substr(0,1)){if(null===i){var d=a.wgArticlePath.replace("$1","");"/"===d&&(d=a.wgServer.substring(a.wgServer.length-4)+"/"),i=e.split(d).pop().split("?")[0]}"edit"===t&&void 0!==i&&$(this).after($("<span>",{class:"in-page-edit-article-link-group"}).append($("<a>",{href:"javascript:void(0)",class:"in-page-edit-article-link",text:o("quick-edit")}).click((function(){var e={};e.page=i,null!==r?e.revision=r:null!==n&&(e.section=n),a.wgIsArticle||(e.reload=!1),s(e)}))))}}})}}},function(e,t,i){const{_msg:a}=i(0),{$br:o}=i(1);e.exports={findAndReplace:function(e){void 0===e&&(e=$(".in-page-edit.ipe-editor:last .editArea"));var t=e.val();ssi_modal.show({className:"in-page-edit",sizeClass:"dialog",center:!0,outSideClose:!1,title:a("fAndR-title"),content:$("<div>",{class:"module far-module"}).append($("<div>",{class:"module_content",id:"findfielddiv"}).append($("<section>").append($("<h4>",{text:a("fAndR-find-text")}),$("<textarea>",{id:"find_this",style:"margin: 0",rows:4}),$("<h4>",{text:a("fAndR-replace-text")}),$("<textarea>",{id:"replace_with",style:"margin: 0",rows:4})),$("<section>",{style:"padding: 7px 0"}).append($("<label>").append($("<input>",{type:"checkbox",id:"globl",checked:""}),$("<span>",{text:a("fAndR-globl")})),o,$("<label>").append($("<input>",{type:"checkbox",id:"case_sen"}),$("<span>",{text:a("fAndR-case-sen")})),o,$("<label>").append($("<input>",{type:"checkbox",id:"regex_search"}),$("<span>",{text:a("fAndR-enable-regex")}))))),buttons:[{label:a("fAndR-button-undo"),className:"btn btn-danger",method(){e.val(t),ssi_modal.notify("info",{className:"in-page-edit",title:a("notify-info"),content:a("notify-fAndR-undo")})}},{className:"btn btn-primary",label:a("fAndR-button-replace"),method(){if(""!==$("#find_this").val()){var t,i="",o=e,n=$("#replace_with").val().replace(/\r/gi,""),s=o.val().replace(/\r/gi,""),r="g",d="i",l=0;!1===$("#globl").prop("checked")&&(r=""),!0===$("#case_sen").prop("checked")&&(d=""),!0===$("#regex_search").prop("checked")&&(l=1);var c=r+d+"m";i=1===l?$("#find_this").val():$("#find_this").val().replace(/\r/gi,"").replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1"),t=new RegExp(i,c);var p=0,m=s.match(t);null!==m&&(p=m.length),s=s.replace(t,n),o.val(s),ssi_modal.notify("success",{className:"in-page-edit",title:a("notify-success"),content:a("notify-fAndR-done",p)})}}}]})}}},function(e,t,i){const{_msg:a}=i(0),{$progress:o}=i(1);e.exports={progress:function(e){if(!0===e)$(".in-page-edit.loadingbox .ssi-modalTitle").html(a("done")),$(".in-page-edit.loadingbox .ipe-progress").addClass("done");else if(!1===e)$(".in-page-edit.loadingbox").length>0&&($(".in-page-edit.loadingbox").appendTo("body"),ssi_modal.close());else{if($(".in-page-edit.loadingbox").length>0)return;void 0===e&&(e="Loading..."),ssi_modal.show({title:e,content:o,className:"in-page-edit loadingbox",center:!0,sizeClass:"dialog",closeIcon:!1,outSideClose:!1})}}}},function(e,t,i){const{_msg:a}=i(0),{$progress:o}=i(1);var n=new mw.Api;e.exports={quickPreview:function(e,t="large",i=!1){var s=$.extend({},{action:"parse",preview:!0,disableeditsection:!0,prop:"text",format:"json"},e);mw.hook("InPageEdit.quickPreview").fire();var r=(new Date).getTime();console.time("[InPageEdit] Request preview"),ssi_modal.show({sizeClass:new RegExp(/dialog|small|smallToMedium|medium|mediumToLarge|large|full|auto/).test(t)?t:"large",center:Boolean(i),className:"in-page-edit previewbox",title:a("preview-title"),content:$("<section>").append(o,$("<div>",{class:"InPageEditPreview","data-timestamp":r,style:"display:none",text:a("preview-placeholder")})),fixedHeight:!0,fitScreen:!0,buttons:[{label:"",className:"hideThisBtn"}],onShow(){$(".previewbox .ipe-progress").css("margin-top",$(".previewbox .ipe-progress").parent().height()/2),$(".previewbox .hideThisBtn").hide(),n.post(s).then((function(e){console.timeEnd("[InPageEdit] Request preview");var t=e.parse.text["*"];$(".previewbox .ipe-progress").hide(150),$('.InPageEditPreview[data-timestamp="'+r+'"]').fadeIn(500).html(t)})).fail((function(){console.timeEnd("[InPageEdit] Request preview"),console.warn("[InPageEdit] 预览失败"),$(".previewbox .ipe-progress").hide(150),$('.InPageEditPreview[data-timestamp="'+r+'"]').fadeIn(500).html(a("preview-error"))}))}})}}},function(e,t,i){var a=new mw.Api,o=mw.config.get();const{_analysis:n}=i(2),{_msg:s}=i(0),{articleLink:r}=i(10),{$br:d,$progress:l}=i(1);var c=function(e){var t,i,p;mw.hook("InPageEdit.quickDiff").fire(),n("quick_diff"),$('[href*="mediawiki.diff.styles"]').length<1&&mw.loader.load(mw.util.wikiScript("load")+"?modules=mediawiki.legacy.shared|mediawiki.diff.styles&only=styles","text/css"),$(".quick-diff").length>0?(console.info("[InPageEdit] Quick diff 正在加载新内容"),t=$(".quick-diff .pageName"),i=$(".quick-diff .diffArea"),p=$(".quick-diff .ipe-progress"),t.text(s("diff-loading")),i.hide(),$(".quick-diff").appendTo("body")):(t=$("<span>",{class:"pageName",text:s("diff-loading")}),i=$("<div>",{class:"diffArea",style:"display: none"}),p=$(l),ssi_modal.show({className:"in-page-edit quick-diff",sizeClass:"large",fixedHeight:!0,fitScreen:!0,title:t,content:$("<div>").append(p,i),buttons:[{label:s("diff-button-todiffpage"),className:"btn btn-secondary toDiffPage",method:function(){}}]})),p.show().css("margin-top",$(".quick-diff .ssi-modalContent").height()/2),$(".quick-diff .toDiffPage").unbind(),e.action="compare",e.prop="diff|diffsize|rel|ids|title|user|comment|parsedcomment|size",e.format="json",e.totext?e.topst=!0:e.fromtext&&(e.frompst=!0),a.post(e).then((function(a){var l,m=a.compare["*"];p.hide(),l=void 0===e.pageName?a.compare.totitle:e.pageName;var f=function(e){return'<a class="diff-user" href="'+mw.util.getUrl("User:"+e)+'">'+e+'</a> (<a href="'+mw.util.getUrl("User_talk:"+e)+'">'+s("diff-usertalk")+'</a> | <a href="'+mw.util.getUrl("Special:Contributions/"+e)+'">'+s("diff-usercontrib")+'</a> | <a href="'+mw.util.getUrl("Special:Block/"+e)+'">'+s("diff-userblock")+"</a>)"};t.html(s("diff-title")+": <u>"+l+"</u>"),i.show().html("").append($("<table>",{class:"diff difftable"}).append($("<colgroup>").append($("<col>",{class:"diff-marker"}),$("<col>",{class:"diff-content"}),$("<col>",{class:"diff-marker"}),$("<col>",{class:"diff-content"})),$("<tbody>").append($("<tr>").append($("<td>",{colspan:2,class:"diff-otitle"}).append($("<a>",{href:o.wgScript+"?oldid="+a.compare.fromrevid,text:a.compare.fromtitle})," (",$("<span>",{class:"diff-version",text:s("diff-version")+a.compare.fromrevid}),") (",$("<a>",{class:"editLink",href:o.wgScript+"?action=edit&title="+a.compare.fromtitle+"&oldid="+a.compare.fromrevid,text:s("diff-edit")}),")",d,f(a.compare.fromuser),d," (",$("<span>",{class:"diff-comment",html:a.compare.fromparsedcomment}),") ",d,$("<a>",{class:"prevVersion ipe-analysis-quick_diff_modalclick",href:"javascript:void(0);",text:"←"+s("diff-prev")}).click(()=>{c({fromrev:a.compare.fromrevid,torelative:"prev"})})),$("<td>",{colspan:2,class:"diff-ntitle"}).append($("<a>",{href:o.wgScript+"?oldid="+a.compare.torevid,text:a.compare.totitle})," (",$("<span>",{class:"diff-version",text:s("diff-version")+a.compare.torevid}),") (",$("<a>",{class:"editLink",href:o.wgScript+"?action=edit&title="+a.compare.totitle+"&oldid="+a.compare.torevid,text:s("diff-edit")}),")",d,f(a.compare.touser),d," (",$("<span>",{class:"diff-comment",html:a.compare.toparsedcomment}),") ",d,$("<a>",{class:"nextVersion ipe-analysis-quick_diff_modalclick",href:"javascript:void(0);",text:s("diff-nextv")+"→"}).click(()=>{n("quick_diff_modalclick"),c({fromrev:a.compare.torevid,torelative:"next"})}))),m,$("<tr>",{class:"diffSize",style:"text-align: center"}).append($("<td>",{colspan:"2",text:a.compare.fromsize+s("diff-bytes")}),$("<td>",{colspan:"2",text:a.compare.tosize+s("diff-bytes")}))))),$(".quick-diff button.toDiffPage").click((function(){location.href=o.wgScript+"?oldid="+a.compare.fromrevid+"&diff="+a.compare.torevid})),r($(".quick-diff .editLink")),!0===e.isPreview&&($(".quick-diff button.toDiffPage").hide(),i.find(".diff-otitle").html("<b>"+s("diff-title-original-content")+"</b>"),i.find(".diff-ntitle").html("<b>"+s("diff-title-your-content")+"</b>")),void 0!==a.compare.fromsize&&void 0!==a.compare.tosize||i.find(".diffSize").hide(),void 0===a.compare.fromrevid&&!0!==e.isPreview?i.find(".diff-otitle").html('<span class="noPrevVerson">'+a.warnings.compare["*"]+"</span>"):void 0===a.compare.torevid&&!0!==e.isPreview&&i.find(".diff-ntitle").html('<span class="noNextVerson">'+a.warnings.compare["*"]+"</span>"),void 0!==a.compare.fromtexthidden&&i.find(".diff-otitle .diff-version").addClass("diff-hidden-history"),void 0!==a.compare.totexthidden&&i.find(".diff-ntitle .diff-version").addClass("diff-hidden-history"),void 0!==a.compare.fromuserhidden&&i.find(".diff-otitle .diff-user").addClass("diff-hidden-history"),void 0!==a.compare.touserhidden&&i.find(".diff-ntitle .diff-user").addClass("diff-hidden-history"),void 0!==a.compare.fromcommenthidden&&i.find(".diff-comment").addClass("diff-hidden-history"),void 0!==a.compare.tocommenthidden&&i.find(".diff-ntitle .diff-comment").addClass("diff-hidden-history"),a.error&&(console.warn("[InPageEdit] 快速差异获取时系统告知出现问题"),i.html(s("diff-error")+": "+a.error.info+"(<code>"+a.error.code+"</code>)"))})).fail((function(e,t,a){console.warn("[InPageEdit] 快速差异获取失败"),p.hide(),i.show().html(s("diff-error")+": "+a.error.info+"(<code>"+a.error.code+"</code>)")}))};e.exports={quickDiff:c}},function(e,t,i){const{_msg:a}=i(0),{_hasRight:o}=i(6),{quickDelete:n}=i(26),{quickEdit:s}=i(7);e.exports={_resolveExists:function(e,t={}){var i=o("delete");"string"==typeof t&&(t={delete:t,edit:t}),ssi_modal.show({className:"in-page-edit resovle-exists",sizeClass:"dialog",center:!0,outSideClose:!1,title:a("target-exists-title"),content:a(i?"target-exists-can-delete":"target-exists-no-delete",e),buttons:[{className:"btn btn-danger btn-exists-delete-target",label:a("quick-delete"),method(i,a){a.close(),n(e,t.delete||null)}},{className:"btn btn-primary",label:a("quick-edit"),method(){s({page:e,summary:t.edit?"[InPageEdit] "+t:null,reload:!1})}},{className:"btn btn-secondary"+(i?" btn-single":""),label:a("cancel"),method:(e,t)=>{t.close()}}],onShow:()=>{i||$(".btn-exists-delete-target").hide()}})}}},function(e,t,i){"use strict";
/**
 * @license GPL-3.0 GNU GENERAL PUBLIC LICENSE 3.0
 *
 * @name InPageEdit
 * @description A useful MediaWiki JavaScript Plugin written with jQuery
 * @author 机智的小鱼君 Dragon-Fish <dragon-fish@qq.com>
 * @url https://github.com/Dragon-Fish/InPageEdit-v2
 */if(void 0!==(window.InPageEdit||{}).version)throw"[InPageEdit] InPageEdit 已经在运行了";var a=i(17);window.InPageEdit=a()},function(e,t,i){const{loadScript:a}=i(18),{getUserInfo:o}=i(19),{loadStyles:n}=i(20),{updateNotice:s}=i(21),{_msg:r}=i(0),{about:d}=i(23),l=i(3),{articleLink:c}=i(10),{findAndReplace:p}=i(11),{loadQuickDiff:m}=i(24),{pluginPreference:f}=i(5),{quickEdit:g}=i(7),{quickPreview:u}=i(13),{quickRedirect:h}=i(25),{quickRename:b}=i(27),{specialNotice:v}=i(9),$=i(4),{versionInfo:w}=i(8);e.exports=function(){n(),a("https://cdn.jsdelivr.net/gh/dragon-fish/inpageedit-v2@master/src/ssi_modal/ssi-modal.min.js").then(()=>{f.set(),o(),m(),c(),s();var e={about:d,api:l,articleLink:c,findAndReplace:p,quickEdit:g,quickPreview:u,quickRedirect:h,quickRename:b,specialNotice:v,version:$,versionInfo:w};return["api","version"].forEach(t=>{try{Object.freeze(e[t])}catch(e){}}),mw.hook("InPageEdit").fire({_msg:r}),console.info("    ____      ____                   ______    ___ __              _    _____ \n   /  _/___  / __ \\____ _____ ____  / ____/___/ (_) /_            | |  / /__ \\\n   / // __ \\/ /_/ / __ `/ __ `/ _ \\/ __/ / __  / / __/  ______    | | / /__/ /\n _/ // / / / ____/ /_/ / /_/ /  __/ /___/ /_/ / / /_   /_____/    | |/ // __/ \n/___/_/ /_/_/    \\__,_/\\__, /\\___/_____/\\__,_/_/\\__/              |___//____/ \n                      /____/"),e})}},function(e,t){e.exports={loadScript:function(e){return $.ajax({url:e,dataType:"script",crossDomain:!0,cache:!0})}}},function(e,t){var i=new mw.Api;e.exports={getUserInfo:function(){mw.user.getRights().then(e=>{console.info("[InPageEdit] 成功获取用户权限信息"),mw.config.set("wgUserRights",e)}).fail((function(){console.warn("[InPageEdit] 警告：无法获取用户权限信息"),mw.config.set("wgUserRights",[])})),null!==mw.user.getName()&&i.get({action:"query",list:"users",usprop:"blockinfo",ususers:mw.user.getName()}).then(e=>{e.query.users[0].blockid?mw.config.set("wgUserIsBlocked",!0):mw.config.set("wgUserIsBlocked",!1)})}}},function(e,t){e.exports={loadStyles:function(){["/src/skin/ipe-default.css","/src/ssi_modal/ssi-modal.css"].forEach(e=>{$("head").prepend($("<link>",{href:"https://cdn.jsdelivr.net/gh/dragon-fish/inpageedit-v2@master"+e,rel:"stylesheet","data-ipe":"style"}))})}}},function(e,t,i){const a=i(4),{_msg:o}=i(0),n=i(3),{versionInfo:s}=i(8),{specialNotice:r}=i(9);e.exports={updateNotice:function(){localStorage.getItem("InPageEditVersion")!==a&&ssi_modal.notify("",{title:o("updatelog-update-success-title"),content:o("updatelog-update-success",a),className:"in-page-edit",buttons:[{className:"btn btn-primary",label:o("updatelog-button-versioninfo"),method:function(e,t){localStorage.InPageEditVersion=a,s(),t.close()}}],closeAfter:{time:30,resetOnHover:!0},onClose:function(){ssi_modal.notify("",{className:"in-page-edit",content:o("updatelog-after-close",`[${n.updatelogsUrl} ${n.updatelogsUrl}]`,`[${n.githubLink}/issues ${o("updatelog-file-issue")}]`),closeAfter:{time:10},buttons:[{className:"btn btn-primary",label:o("ok"),method:function(e,t){t.close()}}]}),localStorage.InPageEditVersion=a}}),localStorage.getItem("InPageEditNoticeId")!==o("noticeid")&&r()}}},function(e){e.exports=JSON.parse('{"name":"inpageedit-v2","version":"14.0.0","description":"A useful MediaWiki JavaScript Plugin written with jQuery","main":"index.js","dependencies":{"jquery":">1.9.x","ssi-modal":"1.0.28"},"devDependencies":{"eslint":"^7.7.0","webpack":"^4.44.1","webpack-cli":"^3.3.12"},"scripts":{"build":"webpack && set MINIFY=1 && webpack","dev":"webpack --watch --output-filename [name].test.js","test":"eslint ./index.js ./module/*.js ./method/*.js"},"repository":{"type":"git","url":"git+https://github.com/Dragon-Fish/InPageEdit-v2.git"},"keywords":["mediawiki","mediawiki-gadget","inpageedit"],"author":"Dragon Fish","license":"GPL-3.0-or-later","bugs":{"url":"https://github.com/Dragon-Fish/InPageEdit-v2/issues"},"homepage":"https://github.com/Dragon-Fish/InPageEdit-v2#readme"}')},function(e,t,i){const{_msg:a}=i(0),o=i(3);e.exports={about:function(){ssi_modal.show({title:a("preference-about-label"),className:"in-page-edit in-page-edit-about",content:$("<section>").append($("<iframe>",{style:"margin: 0;padding: 0;width: 100%;height: 80vh;border: 0;",src:o.aboutUrl}))})}}},function(e,t,i){var a=mw.config.get();const{_msg:o}=i(0),{_analysis:n}=i(2),{quickDiff:s}=i(14);e.exports={loadQuickDiff:function(){function e(){$(".mw-changeslist-groupdiff, .mw-changeslist-diff, .mw-changeslist-diff-cur, .mw-history-histlinks a").unbind("click",e);var e=$(".mw-changeslist-groupdiff, .mw-changeslist-diff, .mw-changeslist-diff-cur, .mw-history-histlinks a").click((function(e){e.preventDefault(),n("quick_diff_recentchanges");var t=$(this).attr("href"),i=mw.util.getParamValue("diff",t),a=mw.util.getParamValue("curid",t),o=mw.util.getParamValue("oldid",t);s("0"===i?{fromrev:o,toid:a}:"prev"===i||"next"===i||"cur"===i?{fromrev:o,torelative:i}:{fromrev:o,torev:i})}))}$(".mw-rcfilters-enabled").length>0?(setInterval(e,500),$(".mw-rcfilters-enabled").addClass("ipe-continuous-active")):e(),"history"===a.wgAction&&($(".historysubmit.mw-history-compareselectedversions-button").after($("<button>").text(o("quick-diff")).click((function(e){e.preventDefault(),n("quick_diff_history_page");var t=$(".selected.before").attr("data-mw-revid"),i=$(".selected.after").attr("data-mw-revid");s({fromrev:i,torev:t})}))),$("[data-mw-revid]").each((function(){var e=$(this),t=e.attr("data-mw-revid");e.find(".mw-history-undo").after($("<span>").html(' | <a class="in-page-edit-article-link" href="javascript:void(0);" onclick="InPageEdit.quickEdit({page:mw.config.get(\'wgPageName\'),revision:'+t+'});">'+o("quick-edit")+"</a>"))})))}}},function(e,t,i){var a=new mw.Api,o=mw.config.get();const{_analysis:n}=i(2),{_msg:s}=i(0),{$br:r,$progress:d}=i(1),{_resolveExists:l}=i(15),{pluginPreference:c}=i(5);e.exports={quickRedirect:function(e="to"){mw.hook("InPageEdit.quickRedirect").fire();var t,i,p,m="#REDIRECT [[:$1]]",f={action:"edit",createonly:1,minor:c.get("editMinor"),format:"json",errorformat:"plaintext"};if("to"===e)f.title=o.wgPageName,t=s("redirect-question-to","<b>"+o.wgPageName.replace(/_/g," ")+"</b>");else{if("from"!==e)return void console.error('[InPageEdit] quickRedirect only accept "from" or "to"');t=s("redirect-question-from","<b>"+o.wgPageName.replace(/_/g," ")+"</b>"),p=s("redirect-summary")+" → [[:"+o.wgPageName+"]]",f.text=m.replace("$1",o.wgPageName)}ssi_modal.show({outSideClose:!1,className:"in-page-edit quick-redirect",center:!0,sizeClass:"dialog",title:s("redirect-title"),content:$("<div>").append($("<section>").append($("<span>",{html:t}),r,$("<input>",{id:"redirect-page",style:"width:96%"}).click((function(){$(this).css("box-shadow","")})),r,$("<label>",{for:"redirect-reason",text:s("editSummary")}),$("<input>",{id:"redirect-reason",style:"width:96%"})),$(d).css("display","none")),buttons:[{label:s("confirm"),className:"btn btn-primary btn-single okBtn",method:function(t,r){function d(t,a){var n,r;($(".in-page-edit.quick-redirect .ipe-progress").hide(),$(".in-page-edit.quick-redirect section").show(),$(".in-page-edit.quick-redirect .okBtn").attr("disabled",!1),$(".in-page-edit.quick-redirect .ipe-progress").addClass("done"),ssi_modal.notify("error",{className:"in-page-edit",content:s("notify-redirect-error")+"<br>"+a.errors[0]["*"]+" (<code>"+t+"</code>)",title:s("notify-error")}),"articleexists"===t)&&("from"===e?(n=i,r=o.wgPageName):"to"===e&&(n=o.wgPageName,r=i),l(n,{delete:"Delete for redirect to [["+r+"]]",edit:"Modify for redirect"}))}""!==(i=$(".in-page-edit.quick-redirect #redirect-page").val())&&i.replace(/_/g," ")!==o.wgPageName.replace(/_/g," ")?(n("quick_redirect"),"to"===e?(p=s("redirect-summary")+" → [[:"+i+"]]",f.text=m.replace("$1",i)):"from"===e&&(f.title=i),""!==$(".in-page-edit.quick-redirect #redirect-reason").val()&&(p=p+" ("+$(".in-page-edit.quick-redirect #redirect-reason").val()+")"),f.summary=p,$(".in-page-edit.quick-redirect .ipe-progress").show(),$(".in-page-edit.quick-redirect section").hide(),$(".in-page-edit.quick-redirect .okBtn").attr("disabled","disabled"),a.postWithToken("csrf",f).done((function(t){if(t.errors)return void d(t.errors[0].code,t);$(".in-page-edit.quick-redirect .ipe-progress").addClass("done"),ssi_modal.notify("success",{className:"in-page-edit",content:s("notify-redirect-success"),title:s("notify-success")}),"to"===e?window.location.reload():($(".in-page-edit.quick-redirect .ipe-progress").addClass("done"),setTimeout((function(){r.close()}),2e3))})).fail(d)):$(".in-page-edit.quick-redirect #redirect-page").css("box-shadow","0 0 4px #f00")}}]})}}},function(e,t,i){var a=new mw.Api,o=mw.config.get();const{_analysis:n}=i(2),{_msg:s}=i(0),{_hasRight:r}=i(6),{$br:d}=i(1);e.exports={quickDelete:function(e,t=""){var i;mw.hook("InPageEdit.quickDelete").fire(),console.log("Quick delete",e,t),e=e||o.wgPageName,ssi_modal.show({outSideClose:!1,className:"in-page-edit quick-delete",center:!0,sizeClass:"dialog",title:s("delete-title"),content:$("<div>").append($("<section>",{id:"InPageEditDeletepage"}).append($("<span>",{html:s("delete-reason","<b>"+e.replace(/_/g," ")+"</b>")}),d,$("<label>",{for:"delete-reason",text:s("editSummary")}),$("<input>",{id:"delete-reason",style:"width:96%",onclick:"$(this).css('box-shadow', '')",value:t}))),beforeShow:function(){if(!r("delete"))return ssi_modal.dialog({title:s("notify-no-right"),content:s("delete-no-right"),className:"in-page-edit quick-deletepage",center:!0,okBtn:{className:"btn btn-primary btn-single"}}),!1},buttons:[{label:s("cancel"),className:"btn btn-primary",method:function(e,t){t.close()}},{label:s("confirm"),className:"btn btn-danger",method:function(t,o){""!==(i=$("#InPageEditDeletepage #delete-reason").val())?(n("quick_delete"),ssi_modal.confirm({center:!0,className:"in-page-edit",title:s("delete-confirm-title"),content:s("delete-confirm-content"),okBtn:{label:s("confirm"),className:"btn btn-danger"},cancelBtn:{label:s("cancel"),className:"btn"}},(function(t){if(!t)return!1;i=s("delete-title")+" ("+i+")",a.postWithToken("csrf",{action:"delete",title:e,reason:i,format:"json"}).then(()=>{ssi_modal.notify("success",{className:"in-page-edit",title:s("notify-success"),content:s("notify-delete-success",e)})}).fail((function(e,t,i){ssi_modal.notify("error",{className:"in-page-edit",title:s("notify-error"),content:s("notify-delete-error")+': <br/><span style="font-size:amall">'+i.error["*"]+"(<code>"+i.error.code+"</code>)</span>"})})),o.close()}))):$("#InPageEditDeletepage #delete-reason").css("box-shadow","0 0 4px #f00")}}]})}}},function(e,t,i){var a=new mw.Api,o=mw.config.get();const{_analysis:n}=i(2),{_msg:s}=i(0),{_hasRight:r}=i(6),{_resolveExists:d}=i(15),{$br:l}=i(1),{progress:c}=i(12);e.exports={quickRename:function(e,t){var i,p,m,f;mw.hook("InPageEdit.quickRename").fire(),e=e||o.wgPageName,t=t||"",ssi_modal.show({outSideClose:!1,className:"in-page-edit quick-rename",center:!0,sizeClass:"dialog",title:s("rename-title"),content:$("<section>").append($("<label>",{for:"move-to",html:s("rename-moveTo","<b>"+e.replace(/_/g," ")+"</b>")}),l,$("<input>",{id:"move-to",style:"width:96%",onclick:"$(this).css('box-shadow','')"}),l,$("<label>",{for:"move-reason",text:s("editSummary")}),l,$("<input>",{id:"move-reason",style:"width:96%"}),l,$("<label>").append($("<input>",{type:"checkbox",id:"movetalk",checked:"checked"}),$("<span>",{text:s("rename-movetalk")})),l,$("<label>").append($("<input>",{type:"checkbox",id:"movesubpages",checked:"checked"}),$("<span>",{text:s("rename-movesubpages")})),l,$("<label>").append($("<input>",{type:"checkbox",id:"noredirect"}),$("<span>",{text:s("rename-noredirect")}))),buttons:[{label:s("cancel"),className:"btn btn-secondary",method:function(e,t){t.close()}},{label:s("confirm"),className:"btn btn-primary",method:function(){""!==(t=$(".in-page-edit.quick-rename #move-to").val())&&t!==o.wgPageName&&t!==o.wgPageName.replace(/_/g," ")?(n("quick_move"),c(s("editor-title-saving")),p=$(".in-page-edit.quick-rename #movetalk").prop("checked"),m=$(".in-page-edit.quick-rename #movesubpages").prop("checked"),f=$(".in-page-edit.quick-rename #noredirect").prop("checked"),i=""===(i=$(".in-page-edit.quick-rename #move-reason").val())?s("rename-summary")+" → [[:"+t+"]]":s("rename-summary")+" → [[:"+t+"]] ("+i+")",a.postWithToken("csrf",{action:"move",from:e,to:t,reason:i,movetalk:p,movesubpages:m,noredirect:f}).done((function(){c(!0),ssi_modal.notify("success",{className:"in-page-edit",content:s("notify-rename-success"),title:s("notify-success")}),location.href=o.wgArticlePath.replace("$1",t)})).fail((function(i,a,o){c(!1),ssi_modal.notify("error",{className:"in-page-edit",content:s("notify-rename-error")+": "+o.error.info+"<code>"+o.error.code+"</code>",title:s("notify-error")}),"articleexists"===o.error.code&&d(t,"For move page [["+e+"]] to here.")}))):$(".in-page-edit.quick-rename #move-to").css("box-shadow","0 0 4px #f00")}}],beforeShow:function(){if(!r("move"))return ssi_modal.dialog({title:s("notify-no-right"),content:s("rename-no-right"),className:"in-page-edit quick-deletepage",center:!0,okBtn:{className:"btn btn-primary btn-single"}}),!1}})}}}]);
//# sourceMappingURL=InPageEdit.min.js.map